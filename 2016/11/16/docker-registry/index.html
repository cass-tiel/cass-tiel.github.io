<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/myvendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/myvendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="docker,registry," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="&amp;#x6458;&amp;#x8981;&amp;#x7531;&amp;#x4E8E;&amp;#x6700;&amp;#x8FD1;&amp;#x5728;&amp;#x505A;&amp;#x4E00;&amp;#x4E2A;docker&amp;#x8FC1;&amp;#x79FB;&amp;#x9879;&amp;#x76EE;&amp;#xFF0C;&amp;#x539F;&amp;#x73AF;&amp;#x5883;&amp;#x662F;&amp;#x4E00;&amp;#x5957;&amp;#x4E70;&amp;#x6765;&amp;#x7684;&amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="docker registry v2 私有仓库搭建">
<meta property="og:url" content="http://c.isme.pub/2016/11/16/docker-registry/index.html">
<meta property="og:site_name" content="Casstiel">
<meta property="og:description" content="&amp;#x6458;&amp;#x8981;&amp;#x7531;&amp;#x4E8E;&amp;#x6700;&amp;#x8FD1;&amp;#x5728;&amp;#x505A;&amp;#x4E00;&amp;#x4E2A;docker&amp;#x8FC1;&amp;#x79FB;&amp;#x9879;&amp;#x76EE;&amp;#xFF0C;&amp;#x539F;&amp;#x73AF;&amp;#x5883;&amp;#x662F;&amp;#x4E00;&amp;#x5957;&amp;#x4E70;&amp;#x6765;&amp;#x7684;&amp;#">
<meta property="og:image" content="http://c.isme.pub/2016/11/16/docker-registry/1.jpg">
<meta property="og:updated_time" content="2016-12-14T03:03:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="docker registry v2 私有仓库搭建">
<meta name="twitter:description" content="&amp;#x6458;&amp;#x8981;&amp;#x7531;&amp;#x4E8E;&amp;#x6700;&amp;#x8FD1;&amp;#x5728;&amp;#x505A;&amp;#x4E00;&amp;#x4E2A;docker&amp;#x8FC1;&amp;#x79FB;&amp;#x9879;&amp;#x76EE;&amp;#xFF0C;&amp;#x539F;&amp;#x73AF;&amp;#x5883;&amp;#x662F;&amp;#x4E00;&amp;#x5957;&amp;#x4E70;&amp;#x6765;&amp;#x7684;&amp;#">
<meta name="twitter:image" content="http://c.isme.pub/2016/11/16/docker-registry/1.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://c.isme.pub/2016/11/16/docker-registry/"/>


  <title> docker registry v2 私有仓库搭建 | Casstiel </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Casstiel</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">普罗米修斯</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                docker registry v2 私有仓库搭建
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-16T17:47:28+08:00" content="2016-11-16">
              2016-11-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/docker/registry/" itemprop="url" rel="index">
                    <span itemprop="name">registry</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="&#x6458;&#x8981;"><a href="#&#x6458;&#x8981;" class="headerlink" title="&#x6458;&#x8981;"></a>&#x6458;&#x8981;</h1><p>&#x7531;&#x4E8E;&#x6700;&#x8FD1;&#x5728;&#x505A;&#x4E00;&#x4E2A;docker&#x8FC1;&#x79FB;&#x9879;&#x76EE;&#xFF0C;&#x539F;&#x73AF;&#x5883;&#x662F;&#x4E00;&#x5957;&#x4E70;&#x6765;&#x7684;&#xFF0C;&#x73B0;&#x5728;&#x4E0D;&#x7528;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x4E58;&#x7740;&#x8FD9;&#x4E2A;&#x673A;&#x4F1A;&#x5C31;&#x6574;&#x4E2A;&#x73AF;&#x5883;&#x91CD;&#x65B0;&#x642D;&#x5EFA;&#x4E86;&#xFF0C;&#x7F51;&#x4E0A;&#x627E;&#x4E86;&#x4E00;&#x5806;&#x4E71;&#x4E03;&#x516B;&#x7CDF;&#x7684;&#x6587;&#x6863;&#xFF0C;&#x770B;&#x7740;&#x90FD;&#x4E0D;&#x592A;&#x4E00;&#x6837;&#xFF0C;&#x6700;&#x7EC8;&#x6574;&#x5408;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x7ECF;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x7EC8;&#x4E8E;&#x8C03;&#x901A;&#x4E86;&#x3002;</p>
<p><img src="/2016/11/16/docker-registry/1.jpg" alt="img"><br><a id="more"></a></p>
<h1 id="&#x5B89;&#x88C5;docker"><a href="#&#x5B89;&#x88C5;docker" class="headerlink" title="&#x5B89;&#x88C5;docker"></a>&#x5B89;&#x88C5;docker</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">apt update &amp;&amp; apt upgrade</div><div class="line">apt install -y curl</div><div class="line">curl https://get.docker.com | sh</div><div class="line"></div><div class="line">apt-get install -y sysv-rc-conf</div><div class="line">sysv-rc-conf</div><div class="line">&#x5C06;docker&#x8BBE;&#x7F6E;&#x5F00;&#x673A;&#x81EA;&#x542F;</div></pre></td></tr></table></figure>
<h1 id="&#x91CD;&#x5EFA;docker0&#x7F51;&#x6865;"><a href="#&#x91CD;&#x5EFA;docker0&#x7F51;&#x6865;" class="headerlink" title="&#x91CD;&#x5EFA;docker0&#x7F51;&#x6865;"></a>&#x91CD;&#x5EFA;docker0&#x7F51;&#x6865;</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">apt-get install bridge-utils</div><div class="line"></div><div class="line">/etc/init.d/docker stop</div><div class="line">ip link <span class="built_in">set</span> dev docker0 down</div><div class="line">brctl delbr docker0</div><div class="line">brctl addbr docker0</div><div class="line">ip addr add 172.30.1.1/24 dev docker0</div><div class="line">ip link <span class="built_in">set</span> dev docker0 up</div><div class="line">/etc/init.d/docker start</div></pre></td></tr></table></figure>
<h1 id="&#x4E0B;&#x8F7D;docker-registry-&#x955C;&#x50CF;"><a href="#&#x4E0B;&#x8F7D;docker-registry-&#x955C;&#x50CF;" class="headerlink" title="&#x4E0B;&#x8F7D;docker registry &#x955C;&#x50CF;"></a>&#x4E0B;&#x8F7D;docker registry &#x955C;&#x50CF;</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker pull registry</div></pre></td></tr></table></figure>
<h1 id="registry-&#x6D4B;&#x8BD5;"><a href="#registry-&#x6D4B;&#x8BD5;" class="headerlink" title="registry &#x6D4B;&#x8BD5;"></a>registry &#x6D4B;&#x8BD5;</h1><!-- more -->
<h2 id="&#x542F;&#x52A8;&#x6D4B;&#x8BD5;"><a href="#&#x542F;&#x52A8;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x542F;&#x52A8;&#x6D4B;&#x8BD5;"></a>&#x542F;&#x52A8;&#x6D4B;&#x8BD5;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">docker run <span class="_">-d</span> -p 5000:5000 \</div><div class="line">--restart=always --name registry \</div><div class="line">-v /data/registry:/var/lib/registry registry</div><div class="line"></div><div class="line">docker ps &#x53EF;&#x4EE5;&#x770B;&#x5230;registry&#x5BB9;&#x5668;</div><div class="line">netstat -ntlp &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x76D1;&#x542C;5000&#x7AEF;&#x53E3;</div><div class="line">curl http://127.0.0.1:5000/v2/_catalog</div><div class="line">&#x770B;&#x5230;&#x8FD4;&#x56DE; {} &#x8868;&#x793A;registry&#x8FD0;&#x884C;&#x6B63;&#x5E38;</div></pre></td></tr></table></figure>
<h2 id="&#x63A8;&#x9001;&#x9A8C;&#x8BC1;"><a href="#&#x63A8;&#x9001;&#x9A8C;&#x8BC1;" class="headerlink" title="&#x63A8;&#x9001;&#x9A8C;&#x8BC1;"></a>&#x63A8;&#x9001;&#x9A8C;&#x8BC1;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">docker tag alpine 172.16.7.3:5000/myalpine</div><div class="line">docker push 172.16.7.3:5000/myalpine</div><div class="line"></div><div class="line">&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x63A8;&#x9001;&#x8BF4;&#x660E;&#x642D;&#x5EFA;&#x6210;&#x529F;</div></pre></td></tr></table></figure>
<h1 id="&#x5E26;&#x9A8C;&#x8BC1;&#x7684;registry"><a href="#&#x5E26;&#x9A8C;&#x8BC1;&#x7684;registry" class="headerlink" title="&#x5E26;&#x9A8C;&#x8BC1;&#x7684;registry"></a>&#x5E26;&#x9A8C;&#x8BC1;&#x7684;registry</h1><h2 id="&#x521B;&#x5EFA;&#x672C;&#x5730;&#x76EE;&#x5F55;"><a href="#&#x521B;&#x5EFA;&#x672C;&#x5730;&#x76EE;&#x5F55;" class="headerlink" title="&#x521B;&#x5EFA;&#x672C;&#x5730;&#x76EE;&#x5F55;"></a>&#x521B;&#x5EFA;&#x672C;&#x5730;&#x76EE;&#x5F55;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir -p /data/registry/{registry,conf,auth}</div></pre></td></tr></table></figure>
<h2 id="&#x751F;&#x6210;&#x7528;&#x6237;&#x548C;&#x5BC6;&#x7801;"><a href="#&#x751F;&#x6210;&#x7528;&#x6237;&#x548C;&#x5BC6;&#x7801;" class="headerlink" title="&#x751F;&#x6210;&#x7528;&#x6237;&#x548C;&#x5BC6;&#x7801;"></a>&#x751F;&#x6210;&#x7528;&#x6237;&#x548C;&#x5BC6;&#x7801;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /data/registry/auth</div><div class="line">docker run --entrypoint htpasswd registry -Bbn httx httx_password &gt; htpasswd;</div></pre></td></tr></table></figure>
<h2 id="&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;"><a href="#&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;" class="headerlink" title="&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;"></a>&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">cd</span> /data/registry/conf</div><div class="line">vim config.yml</div><div class="line">    version: 0.1</div><div class="line">    <span class="built_in">log</span>:</div><div class="line">      fields:</div><div class="line">        service: registry</div><div class="line">    storage:</div><div class="line">      cache:</div><div class="line">        blobdescriptor: inmemory</div><div class="line">      filesystem:</div><div class="line">        rootdirectory: /var/lib/registry</div><div class="line">    http:</div><div class="line">      addr: :5000</div><div class="line">      headers:</div><div class="line">        X-Content-Type-Options: [nosniff]</div><div class="line">    health:</div><div class="line">      storagedriver:</div><div class="line">        enabled: <span class="literal">true</span></div><div class="line">        interval: 10s</div><div class="line">        threshold: 3</div></pre></td></tr></table></figure>
<h2 id="&#x542F;&#x52A8;&#x547D;&#x4EE4;"><a href="#&#x542F;&#x52A8;&#x547D;&#x4EE4;" class="headerlink" title="&#x542F;&#x52A8;&#x547D;&#x4EE4;"></a>&#x542F;&#x52A8;&#x547D;&#x4EE4;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">docker run <span class="_">-d</span> -p 5000:5000 \</div><div class="line">--restart=always --name registry \</div><div class="line">-v /data/registry/auth:/auth \</div><div class="line"><span class="_">-e</span> <span class="string">&quot;REGISTRY_AUTH=htpasswd&quot;</span> \</div><div class="line"><span class="_">-e</span> <span class="string">&quot;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm&quot;</span> \</div><div class="line"><span class="_">-e</span> <span class="string">&quot;REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd&quot;</span> \</div><div class="line">-v /data/registry/conf:/etc/docker/registry/ \</div><div class="line">-v /data/registry/registry:/var/lib/registry registry</div></pre></td></tr></table></figure>
<h2 id="&#x9A8C;&#x8BC1;&#x6D4B;&#x8BD5;"><a href="#&#x9A8C;&#x8BC1;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x9A8C;&#x8BC1;&#x6D4B;&#x8BD5;"></a>&#x9A8C;&#x8BC1;&#x6D4B;&#x8BD5;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">docker login http://172.16.7.3:5000</div><div class="line">docker push 172.16.7.3:5000/myalpine</div><div class="line">curl http://httx:httx_password@127.0.0.1:5000/v2/_catalog</div></pre></td></tr></table></figure>
<h1 id="&#x7ED9;registry&#x6DFB;&#x52A0;nginx-https&#x4EE3;&#x7406;&#x9A8C;&#x8BC1;"><a href="#&#x7ED9;registry&#x6DFB;&#x52A0;nginx-https&#x4EE3;&#x7406;&#x9A8C;&#x8BC1;" class="headerlink" title="&#x7ED9;registry&#x6DFB;&#x52A0;nginx+https&#x4EE3;&#x7406;&#x9A8C;&#x8BC1;"></a>&#x7ED9;registry&#x6DFB;&#x52A0;nginx+https&#x4EE3;&#x7406;&#x9A8C;&#x8BC1;</h1><h2 id="&#x7F16;&#x8BD1;&#x5B89;&#x88C5;nginx1-9-15&#x3001;&#x521B;&#x5EFA;ngxin&#x542F;&#x52A8;&#x6587;&#x4EF6;&#x3001;&#x521B;&#x5EFA;nginx&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8BF7;&#x53C2;&#x7167;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;"><a href="#&#x7F16;&#x8BD1;&#x5B89;&#x88C5;nginx1-9-15&#x3001;&#x521B;&#x5EFA;ngxin&#x542F;&#x52A8;&#x6587;&#x4EF6;&#x3001;&#x521B;&#x5EFA;nginx&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8BF7;&#x53C2;&#x7167;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;" class="headerlink" title="&#x7F16;&#x8BD1;&#x5B89;&#x88C5;nginx1.9.15&#x3001;&#x521B;&#x5EFA;ngxin&#x542F;&#x52A8;&#x6587;&#x4EF6;&#x3001;&#x521B;&#x5EFA;nginx&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8BF7;&#x53C2;&#x7167;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;"></a>&#x7F16;&#x8BD1;&#x5B89;&#x88C5;nginx1.9.15&#x3001;&#x521B;&#x5EFA;ngxin&#x542F;&#x52A8;&#x6587;&#x4EF6;&#x3001;&#x521B;&#x5EFA;nginx&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8BF7;&#x53C2;&#x7167;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;</h2><blockquote>
<p>nginx1.9.15 &#x7F16;&#x8BD1;&#x5B89;&#x88C5;</p>
</blockquote>
<h2 id="&#x5236;&#x4F5C;ca&#x8BC1;&#x4E66;"><a href="#&#x5236;&#x4F5C;ca&#x8BC1;&#x4E66;" class="headerlink" title="&#x5236;&#x4F5C;ca&#x8BC1;&#x4E66;"></a>&#x5236;&#x4F5C;ca&#x8BC1;&#x4E66;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/nginx/conf/ssl</div><div class="line"></div><div class="line">mkdir -p demoCA/newcerts</div><div class="line">touch demoCA/index.txt</div><div class="line"><span class="built_in">echo</span> 01 &gt; demoCA/serial</div><div class="line"><span class="comment"># &#x4E0A;&#x9762;&#x8FD9;&#x4E2A;&#x4E0D;&#x9519;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x62A5;&#x9519;</span></div><div class="line">Using configuration from /usr/lib/ssl/openssl.cnf</div><div class="line">Enter pass phrase <span class="keyword">for</span> ca.key:</div><div class="line">I am unable to access the ./demoCA/newcerts directory</div><div class="line">./demoCA/newcerts: No such file or directory</div><div class="line"></div><div class="line">&#x751F;&#x6210;&#x6839;&#x8BC1;&#x4E66;</div><div class="line"></div><div class="line">openssl genrsa -out ca.key 2048</div><div class="line"></div><div class="line">openssl req -new -x509 -days 7305 -key ca.key -out ca.crt</div><div class="line"></div><div class="line"><span class="comment"># &#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;CN&#x4E00;&#x5B9A;&#x8981;&#x5929;&#x586B;&#x5199;&#x4F60;&#x7684;&#x57DF;&#x540D;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x914D;&#x7F6E;&#x9700;&#x8981;&#x4E00;&#x81F4;</span></div><div class="line">Common Name (e.g. server FQDN or YOUR name) []:opreg.chinawayltd.com</div><div class="line">Email Address []:xxx@163.com</div></pre></td></tr></table></figure>
<h2 id="&#x751F;&#x6210;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;&#x5E76;&#x7528;ca&#x8BC1;&#x4E66;&#x8BA4;&#x8BC1;"><a href="#&#x751F;&#x6210;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;&#x5E76;&#x7528;ca&#x8BC1;&#x4E66;&#x8BA4;&#x8BC1;" class="headerlink" title="&#x751F;&#x6210;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;&#x5E76;&#x7528;ca&#x8BC1;&#x4E66;&#x8BA4;&#x8BC1;"></a>&#x751F;&#x6210;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;&#x5E76;&#x7528;ca&#x8BC1;&#x4E66;&#x8BA4;&#x8BC1;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">openssl genrsa -out opreg.key 2048</div><div class="line"></div><div class="line">openssl req -new -key opreg.key -out opreg.chinawayltd.com.csr</div><div class="line"></div><div class="line"><span class="comment"># &#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;CN&#x4E00;&#x5B9A;&#x8981;&#x5929;&#x586B;&#x5199;&#x4F60;&#x7684;&#x57DF;&#x540D;&#xFF0C; &#x8DDF;&#x524D;&#x9762;&#x7684;&#x914D;&#x7F6E;&#x9700;&#x8981;&#x4E00;&#x81F4;</span></div><div class="line">Common Name (e.g. server FQDN or YOUR name) []:opreg.chinawayltd.com</div><div class="line">Email Address []:xxx@163.com</div><div class="line"></div><div class="line"><span class="comment"># challenge password &#x4E00;&#x5B9A;&#x8981;&#x4E3A;&#x7A7A;</span></div><div class="line"></div><div class="line">openssl ca -policy policy_anything -days 1460 -cert ca.crt -keyfile ca.key -in opreg.chinawayltd.com.csr -out opreg.chinawayltd.com.crt</div><div class="line"></div><div class="line">mkdir -p /etc/docker/certs.d/opreg.chinawayltd.com/</div><div class="line">cp ca.crt /etc/docker/certs.d/opreg.chinawayltd.com/</div></pre></td></tr></table></figure>
<h2 id="&#x751F;&#x6210;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;"><a href="#&#x751F;&#x6210;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;" class="headerlink" title="&#x751F;&#x6210;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;"></a>&#x751F;&#x6210;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">htpasswd -c conf/.htpasswd httx</div></pre></td></tr></table></figure>
<h2 id="&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x4E3B;&#x673A;"><a href="#&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x4E3B;&#x673A;" class="headerlink" title="&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x4E3B;&#x673A;"></a>&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x4E3B;&#x673A;</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line">vim conf/vhosts/opreg.conf</div><div class="line"></div><div class="line">upstream docker-registry {</div><div class="line">	server 127.0.0.1:5000;</div><div class="line">}</div><div class="line"></div><div class="line">server {</div><div class="line">	listen 443 default_server;</div><div class="line">	server_name opreg.chinawayltd.com;</div><div class="line"></div><div class="line">	ssl on;</div><div class="line">	ssl_certificate     /usr/<span class="built_in">local</span>/nginx/conf/ssl/opreg.chinawayltd.com.crt;</div><div class="line">	ssl_certificate_key /usr/<span class="built_in">local</span>/nginx/conf/ssl/opreg.key;</div><div class="line">	ssl_session_timeout 5m;</div><div class="line">	ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;</div><div class="line">	ssl_ciphers         ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;</div><div class="line">	ssl_prefer_server_ciphers on;</div><div class="line">	ssl_session_cache   shared:demo-pay:4m;</div><div class="line"></div><div class="line">	<span class="comment"># set HSTS-Header because we only allow https traffic</span></div><div class="line">	add_header Strict-Transport-Security <span class="string">&quot;max-age=31536000; includeSubdomains&quot;</span>;</div><div class="line"></div><div class="line">	proxy_set_header Host       <span class="variable">$http_host</span>;   <span class="comment"># required for Docker client sake</span></div><div class="line">	proxy_set_header X-Real-IP  <span class="variable">$remote_addr</span>; <span class="comment"># pass on real client IP</span></div><div class="line"></div><div class="line">	client_max_body_size 0; <span class="comment"># disable any limits to avoid HTTP 413 for large image uploads</span></div><div class="line"></div><div class="line">	<span class="comment"># required to avoid HTTP 411: see Issue #1486 (https://github.com/dotcloud/docker/issues/1486)</span></div><div class="line">	chunked_transfer_encoding on;</div><div class="line"></div><div class="line">	location / {</div><div class="line">	<span class="comment"># let Nginx know about our auth file</span></div><div class="line">		auth_basic              <span class="string">&quot;Restricted&quot;</span>;</div><div class="line">		auth_basic_user_file /usr/<span class="built_in">local</span>/nginx/conf/.htpasswd;</div><div class="line"></div><div class="line">		proxy_pass http://docker-registry;</div><div class="line">	}</div><div class="line">	location /_ping {</div><div class="line">		auth_basic off;</div><div class="line">		proxy_pass http://docker-registry;</div><div class="line">	}</div><div class="line">	location /v1/_ping {</div><div class="line">		auth_basic off;</div><div class="line">		proxy_pass http://docker-registry;</div><div class="line">	}</div><div class="line">	location /v2/ {</div><div class="line">		<span class="keyword">if</span> (<span class="variable">$http_user_agent</span> ~ <span class="string">&quot;^(docker\/1\.(3|4|5(?!\.[0-9]-dev))|Go ).*\$&quot;</span> ) {</div><div class="line">			<span class="built_in">return</span> 404;</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="comment"># To add basic authentication to v2 use auth_basic setting plus add_header</span></div><div class="line">		auth_basic <span class="string">&quot;Registry realm&quot;</span>;</div><div class="line">		auth_basic_user_file /usr/<span class="built_in">local</span>/nginx/conf/.htpasswd;</div><div class="line">		<span class="comment"># tengine 2.1.2</span></div><div class="line">		add_header <span class="string">&apos;Docker-Distribution-Api-Version&apos;</span> <span class="string">&apos;registry/2.0&apos;</span>;</div><div class="line">		<span class="comment"># nginx 1.9.15</span></div><div class="line">		<span class="comment">#add_header &apos;Docker-Distribution-Api-Version&apos; &apos;registry/2.0&apos; always;</span></div><div class="line"></div><div class="line">		proxy_pass                          http://docker-registry;</div><div class="line">		proxy_set_header  Host              <span class="variable">$http_host</span>;   <span class="comment"># required for docker client&apos;s sake</span></div><div class="line">			proxy_set_header  X-Real-IP         <span class="variable">$remote_addr</span>; <span class="comment"># pass on real client&apos;s IP</span></div><div class="line">			proxy_set_header  X-Forwarded-For   <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line">		proxy_set_header  X-Forwarded-Proto <span class="variable">$scheme</span>;</div><div class="line">		proxy_read_timeout                  900;</div><div class="line">	}</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>
<h2 id="client-&#x914D;&#x7F6E;"><a href="#client-&#x914D;&#x7F6E;" class="headerlink" title="client &#x914D;&#x7F6E;"></a>client &#x914D;&#x7F6E;</h2><p>&#x5C06;&#x81EA;&#x7B7E;ca&#x8BC1;&#x4E66;&#x53D1;&#x9001;&#x5230;&#x5BA2;&#x6237;&#x7AEF;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir -p /etc/docker/certs.d/opreg.chinawayltd.com/</div><div class="line">scp 172.16.7.1:/etc/docker/certs.d/opreg.chinawayltd.com/ca.crt /etc/docker/certs.d/opreg.chinawayltd.com/</div></pre></td></tr></table></figure>
<h1 id="docker-api"><a href="#docker-api" class="headerlink" title="docker api"></a>docker api</h1><blockquote>
<p>&#x4EE5;&#x4E0B;&#x5173;&#x4E8E;docker registry api &#x7684;&#x5185;&#x5BB9;&#x53D6;&#x81EA;&#xFF08;<a href="http://blog.csdn.net/ztsinghua/article/details/51496658&#xFF09;" target="_blank" rel="external">http://blog.csdn.net/ztsinghua/article/details/51496658&#xFF09;</a></p>
</blockquote>
<p>docker registry v2&#x7248;&#x672C;&#x7684;http api &#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5408;&#x9002;&#x7684;&#xFF0C;&#x81EA;&#x5DF1;&#x901A;&#x8FC7;&#x9605;&#x8BFB;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x6574;&#x7406;&#x4E86;&#x4E00;&#x4E0B;&#x3002;<br>&#x6982;&#x8981;</p>
<table>
<thead>
<tr>
<th style="text-align:center">method</th>
<th style="text-align:center">path</th>
<th style="text-align:center">Entity</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">/v2/</td>
<td style="text-align:center">Base</td>
<td style="text-align:center">Check that the endpoint implements Docker Registry API V2.</td>
</tr>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">/v2/<name>/tags/list</name></td>
<td style="text-align:center">Tags</td>
<td style="text-align:center">Fetch the tags under the repository identified by name.</td>
</tr>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">/v2/<name>/manifests/<reference></reference></name></td>
<td style="text-align:center">Manifest</td>
<td style="text-align:center">Fetch the manifest identified by nameand referencewhere referencecan be a tag or digest. A HEADrequest can also be issued to this endpoint to obtain resource information without receiving all data.</td>
</tr>
<tr>
<td style="text-align:center">PUT</td>
<td style="text-align:center">/v2/<name>/manifests/<reference></reference></name></td>
<td style="text-align:center">Manifest</td>
<td style="text-align:center">Put the manifest identified by nameand referencewhere referencecan be a tag or digest.</td>
</tr>
<tr>
<td style="text-align:center">DELETE</td>
<td style="text-align:center">/v2/<name>/manifests/<reference></reference></name></td>
<td style="text-align:center">Manifest</td>
<td style="text-align:center">Delete the manifest identified by nameand reference. Note that a manifest can only be deleted by digest.</td>
</tr>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">/v2/<name>/blobs/<digest></digest></name></td>
<td style="text-align:center">Blob</td>
<td style="text-align:center">Retrieve the blob from the registry identified bydigest. A HEADrequest can also be issued to this endpoint to obtain resource information without receiving all data.</td>
</tr>
<tr>
<td style="text-align:center">DELETE</td>
<td style="text-align:center">/v2/<name>/blobs/<digest></digest></name></td>
<td style="text-align:center">Blob</td>
<td style="text-align:center">Delete the blob identified by nameand digest</td>
</tr>
<tr>
<td style="text-align:center">POST</td>
<td style="text-align:center">/v2/<name>/blobs/uploads/</name></td>
<td style="text-align:center">Initiate Blob</td>
<td style="text-align:center">Upload    Initiate a resumable blob upload. If successful, an upload location will be provided to complete the upload. Optionally, if thedigest parameter is present, the request body will be used to complete the upload in a single request.</td>
</tr>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">/v2/<name>/blobs/uploads/<uuid></uuid></name></td>
<td style="text-align:center">Blob Upload</td>
<td style="text-align:center">Retrieve status of upload identified byuuid. The primary purpose of this endpoint is to resolve the current status of a resumable upload.</td>
</tr>
<tr>
<td style="text-align:center">PATCH</td>
<td style="text-align:center">/v2/<name>/blobs/uploads/<uuid></uuid></name></td>
<td style="text-align:center">Blob Upload</td>
<td style="text-align:center">Upload a chunk of data for the specified upload.</td>
</tr>
<tr>
<td style="text-align:center">PUT</td>
<td style="text-align:center">/v2/<name>/blobs/uploads/<uuid></uuid></name></td>
<td style="text-align:center">Blob Upload</td>
<td style="text-align:center">Complete the upload specified by uuid, optionally appending the body as the final chunk.</td>
</tr>
<tr>
<td style="text-align:center">DELETE</td>
<td style="text-align:center">/v2/<name>/blobs/uploads/<uuid></uuid></name></td>
<td style="text-align:center">Blob Upload</td>
<td style="text-align:center">Cancel outstanding upload processes, releasing associated resources. If this is not called, the unfinished uploads will eventually timeout.</td>
</tr>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">/v2/_catalog</td>
<td style="text-align:center">Catalog</td>
<td style="text-align:center">Retrieve a sorted, json list of repositories available in the registry.</td>
</tr>
</tbody>
</table>
<h1 id="&#x4E13;&#x6709;&#x540D;&#x8BCD;&#x89E3;&#x91CA;"><a href="#&#x4E13;&#x6709;&#x540D;&#x8BCD;&#x89E3;&#x91CA;" class="headerlink" title="&#x4E13;&#x6709;&#x540D;&#x8BCD;&#x89E3;&#x91CA;"></a>&#x4E13;&#x6709;&#x540D;&#x8BCD;&#x89E3;&#x91CA;</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div></pre></td><td class="code"><pre><div class="line">repository name&#xFF08;&#x5B58;&#x50A8;&#x5E93;&#x540D;&#x79F0;&#xFF09;</div><div class="line">&#x5B58;&#x50A8;&#x5E93;&#x6307;&#x5728;&#x5E93;&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x955C;&#x50CF;</div><div class="line">&#x8BED;&#x6CD5;</div><div class="line">&#x7ECF;&#x5178;&#x5B58;&#x50A8;&#x5E93;&#x540D;&#x79F0;&#x7531;&#x4E24;&#x7EA7;&#x8DEF;&#x5F84;&#x6784;&#x6210;&#xFF0C;&#x6BCF;&#x7EA7;&#x8DEF;&#x5F84;&#x5C0F;&#x4E8E;30&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;v2&#x7684;api&#x4E0D;&#x5F3A;&#x5236;&#x8981;&#x6C42;&#x8FD9;&#x6837;&#x7684;&#x683C;&#x5F0F;</div><div class="line">&#x6BCF;&#x7EA7;&#x8DEF;&#x5F84;&#x540D;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x6216;&#x8005;&#x6570;&#x5B57;&#xFF0C;&#x4F7F;&#x7528;&#x53E5;&#x53F7;&#xFF0C;&#x7834;&#x6298;&#x53F7;&#x548C;&#x4E0B;&#x5212;&#x7EBF;&#x5206;&#x9694;&#x3002; &#x66F4;&#x4E25;&#x683C;&#x6765;&#x8BF4;&#xFF0C;&#x5B83;&#x5FC5;&#x987B;&#x7B26;&#x5408;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF1A;[a-z0-9]+(?:[._-][a-z0-9]+)*</div><div class="line">&#x591A;&#x7EA7;&#x8DEF;&#x5F84;&#x7528;/&#x5206;&#x9694;</div><div class="line">&#x5B58;&#x50A8;&#x5E93;&#x540D;&#x79F0;&#x603B;&#x957F;&#x5EA6;&#xFF08;&#x5305;&#x62EC;/&#xFF09;&#x4E0D;&#x80FD;&#x8D85;&#x8FC7;256&#x4E2A;&#x5B57;&#x7B26;</div><div class="line">digest&#xFF08;&#x6982;&#x8981;&#xFF09;</div><div class="line">&#x6982;&#x8981;&#x662F;&#x955C;&#x50CF;&#x5404;&#x4E2A;&#x5C42;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x3002;&#x867D;&#x7136;&#x7B97;&#x6CD5;&#x5141;&#x8BB8;&#x4F7F;&#x7528;&#x4EFB;&#x610F;&#x7B97;&#x6CD5;&#xFF0C;&#x4F46;&#x662F;&#x4E3A;&#x4E86;&#x517C;&#x5BB9;&#x6027;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;sha256&#x3002;</div><div class="line">&#x4F8B;&#xFF1A;sha256:6c3c624b58dbbcd3c0dd82b4c53f04194d1247c6eebdaab7c610cf7d66709b3b</div><div class="line">&#x8BED;&#x6CD5;</div><div class="line">digest    := algorithm &quot;:&quot; hex</div><div class="line">algorithm := /[A-Fa-f0-9_+.-]+/</div><div class="line">hex       := /[A-Fa-f0-9]+/</div><div class="line">&#x751F;&#x6210;&#x6458;&#x8981;&#x7684;&#x4F2A;&#x4EE3;&#x7801;</div><div class="line">let C = &apos;a small string&apos;</div><div class="line">let B = sha256(C)</div><div class="line">let D = &apos;sha256:&apos; + EncodeHex(B)</div><div class="line">let ID(C) = D</div><div class="line">PULL&#x955C;&#x50CF;&#x8FC7;&#x7A0B;</div><div class="line"></div><div class="line">&#x955C;&#x50CF;&#x7531;&#x4E00;&#x4E2A;json&#x6E05;&#x5355;&#x548C; &#x5C42;&#x53E0;&#x6587;&#x4EF6;&#x7EC4;&#x6210;&#xFF0C;pull&#x955C;&#x50CF;&#x7684;&#x8FC7;&#x7A0B;&#x5C31;&#x662F;&#x68C0;&#x7D22;&#x8FD9;&#x4E24;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x8FC7;&#x7A0B;&#x3002;</div><div class="line">&#x62C9;&#x53D6;&#x955C;&#x50CF;&#x7684;&#x7B2C;&#x4E00;&#x6B65;&#x5C31;&#x662F;&#x83B7;&#x53D6;&#x6E05;&#x5355;&#xFF0C;&#x6E05;&#x5355;&#x7531;&#x4E0B;&#x9762;&#x51E0;&#x4E2A;&#x5B57;&#x6BB5;&#x7EC4;&#x6210;&#xFF1A;</div><div class="line"></div><div class="line">&#x5B57;&#x6BB5;	&#x63CF;&#x8FF0;</div><div class="line">name	&#x955C;&#x50CF;&#x540D;&#x79F0;</div><div class="line">tag	&#x955C;&#x50CF;&#x5F53;&#x524D;&#x7248;&#x672C;&#x7684;tag</div><div class="line">fsLayers	&#x5C42;&#x63CF;&#x8FF0;&#x5217;&#x8868;(&#x5305;&#x542B;&#x6458;&#x8981;)</div><div class="line">signature	&#x4E00;&#x4E2A;JWS&#x7B7E;&#x540D;&#xFF0C;&#x7528;&#x6765;&#x9A8C;&#x8BC1;&#x6E05;&#x5355;&#x5185;&#x5BB9;</div><div class="line"></div><div class="line">&#x5F53;&#x83B7;&#x53D6;&#x6E05;&#x5355;&#x4E4B;&#x540E;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&#xFF08;signature&#xFF09;&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x540D;&#x79F0;&#x548C;&#x5C42;&#x662F;&#x6709;&#x6548;&#x7684;&#x3002;&#x786E;&#x8BA4;&#x540E;&#xFF0C;</div><div class="line">&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;digest&#x53BB;&#x4E0B;&#x8F7D;&#x5404;&#x4E2A;&#x5C42;&#xFF0C;&#x5728;v2API&#x4E2D;&#xFF0C;&#x5C42;&#x5B58;&#x50A8;&#x5728;blobs&#x4E2D;&#x4EE5;digest&#x4F5C;&#x4E3A;&#x952E;&#x503C;&#x3002;</div><div class="line">Pulling an Image Manifest&#xFF08;&#x62C9;&#x53D6;&#x955C;&#x50CF;&#x6E05;&#x5355;&#xFF09;</div><div class="line">API</div><div class="line">&gt;&gt;&gt; HEAD /v2/&lt;name&gt;/manifests/&lt;reference&gt; #&#x68C0;&#x67E5;&#x955C;&#x50CF;&#x6E05;&#x5355;&#x662F;&#x5426;&#x5B58;&#x5728;</div><div class="line">&gt;&gt;&gt; GET /v2/&lt;name&gt;/manifests/&lt;reference&gt;  #&#x62C9;&#x53D6;&#x955C;&#x50CF;&#x6E05;&#x5355;</div><div class="line">Note</div><div class="line"></div><div class="line">reference&#x53EF;&#x4EE5;&#x662F;tag&#x6216;&#x8005;&#x662F;digest</div><div class="line">Pulling a Layer&#xFF08;&#x62C9;&#x53D6;&#x5C42;&#xFF09;</div><div class="line">API</div><div class="line">&gt;&gt;&gt; GET /v2/&lt;name&gt;/blobs/&lt;digest&gt;</div><div class="line">PUSHING&#x955C;&#x50CF;&#x8FC7;&#x7A0B;</div><div class="line"></div><div class="line">&#x63A8;&#x955C;&#x50CF;&#x548C;&#x62C9;&#x53D6;&#x955C;&#x50CF;&#x8FC7;&#x7A0B;&#x76F8;&#x53CD;&#xFF0C;&#x5148;&#x63A8;&#x5404;&#x4E2A;&#x5C42;&#x5230;registry&#x4ED3;&#x5E93;&#xFF0C;&#x7136;&#x540E;&#x4E0A;&#x4F20;&#x6E05;&#x5355;&#x3002;</div><div class="line"></div><div class="line">Pushing a Layer&#xFF08;&#x4E0A;&#x4F20;&#x5C42;&#xFF09;</div><div class="line">&#x4E0A;&#x4F20;&#x5C42;&#x5206;&#x4E3A;&#x4E24;&#x6B65;&#xFF0C;&#x7B2C;&#x4E00;&#x6B65;&#x4F7F;&#x7528;post&#x8BF7;&#x6C42;&#x5728;registry&#x4ED3;&#x5E93;&#x542F;&#x52A8;&#x4E0A;&#x4F20;&#x670D;&#x52A1;</div><div class="line">&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;url&#xFF0C;&#x8FD9;&#x4E2A;url&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4E0A;&#x4F20;&#x6570;&#x636E;&#x548C;&#x68C0;&#x67E5;&#x72B6;&#x6001;&#x3002;</div><div class="line">Existing Layers(&#x68C0;&#x67E5;&#x5C42;&#x662F;&#x5426;&#x5B58;&#x5728;)</div><div class="line">API</div><div class="line">&gt;&gt;&gt; HEAD /v2/&lt;name&gt;/blobs/&lt;digest&gt;</div><div class="line">RETURN</div><div class="line"></div><div class="line">&#x82E5;&#x8FD4;&#x56DE;200 OK&#x5219;&#x8868;&#x793A;&#x5B58;&#x5728;&#xFF0C;&#x4E0D;&#x7528;&#x4E0A;&#x4F20;</div><div class="line">Starting An Upload(&#x542F;&#x52A8;&#x4E0A;&#x4F20;&#x670D;&#x52A1;)</div><div class="line">API</div><div class="line">&gt;&gt;&gt; POST /v2/&lt;name&gt;/blobs/uploads/</div><div class="line">RETURN</div><div class="line">&#x5982;&#x679C;post&#x8BF7;&#x6C42;&#x8FD4;&#x56DE;202 accepted&#xFF0C;&#x4E00;&#x4E2A;url&#x4F1A;&#x5728;location&#x5B57;&#x6BB5;&#x8FD4;&#x56DE;.</div><div class="line"></div><div class="line">202 Accepted</div><div class="line">Location: /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">Range: bytes=0-&lt;offset&gt;</div><div class="line">Content-Length: 0</div><div class="line">Docker-Upload-UUID: &lt;uuid&gt; # &#x53EF;&#x4EE5;&#x7528;&#x6765;&#x67E5;&#x770B;&#x4E0A;&#x4F20;&#x72B6;&#x6001;&#x548C;&#x5B9E;&#x73B0;&#x65AD;&#x70B9;&#x7EED;&#x4F20;</div><div class="line">Uploading the Layer(&#x4E0A;&#x4F20;&#x5C42;)</div><div class="line">Upload Progress(&#x4E0A;&#x4F20;&#x8FDB;&#x5EA6;)</div><div class="line">API</div><div class="line">&gt;&gt;&gt; GET /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">&gt;&gt;&gt; Host: &lt;registry host&gt;</div><div class="line">RETURN</div><div class="line">204 No Content</div><div class="line">Location: /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">Range: bytes=0-&lt;offset&gt;</div><div class="line">Docker-Upload-UUID: &lt;uuid&gt;</div><div class="line">Monolithic Upload(&#x6574;&#x5757;&#x4E0A;&#x4F20;&#xFF09;</div><div class="line">API</div><div class="line">&gt;&gt;&gt; PUT /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;?digest=&lt;digest&gt;</div><div class="line">&gt;&gt;&gt; Content-Length: &lt;size of layer&gt;</div><div class="line">&gt;&gt;&gt; Content-Type: application/octet-stream</div><div class="line">&lt;Layer Binary Data&gt;</div><div class="line">Chunked Upload&#xFF08;&#x5206;&#x5757;&#x4E0A;&#x4F20;&#xFF09;</div><div class="line">API</div><div class="line">&gt;&gt;&gt; PATCH /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">&gt;&gt;&gt; Content-Length: &lt;size of chunk&gt;</div><div class="line">&gt;&gt;&gt; Content-Range: &lt;start of range&gt;-&lt;end of range&gt;</div><div class="line">&gt;&gt;&gt; Content-Type: application/octet-stream</div><div class="line">&lt;Layer Chunk Binary Data&gt;</div><div class="line">RETURN</div><div class="line">&#x5982;&#x679C;&#x670D;&#x52A1;&#x5668;&#x4E0D;&#x63A5;&#x53D7;&#x8FD9;&#x4E2A;&#x5757;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#xFF1A;</div><div class="line">416 Requested Range Not Satisfiable</div><div class="line">Location: /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">Range: 0-&lt;last valid range&gt;</div><div class="line">Content-Length: 0</div><div class="line">Docker-Upload-UUID: &lt;uuid&gt;</div><div class="line">&#x6210;&#x529F;&#x8FD4;&#x56DE;&#xFF1A;</div><div class="line">202 Accepted</div><div class="line">Location: /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">Range: bytes=0-&lt;offset&gt;</div><div class="line">Content-Length: 0</div><div class="line">Docker-Upload-UUID: &lt;uuid&gt;</div><div class="line">Completed Upload(&#x4E0A;&#x4F20;&#x5B8C;&#x6210;)</div><div class="line">&#x5206;&#x5757;&#x4E0A;&#x4F20;&#x5728;&#x6700;&#x540E;&#x4E00;&#x5757;&#x4E0A;&#x4F20;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x9700;&#x8981;&#x63D0;&#x4EA4;&#x4E00;&#x4E2A;&#x4E0A;&#x4F20;&#x5B8C;&#x6210;&#x7684;&#x8BF7;&#x6C42;</div><div class="line"></div><div class="line">API</div><div class="line">&gt;&gt;&gt; PUT /v2/&lt;name&gt;/blob/uploads/&lt;uuid&gt;?digest=&lt;digest&gt;</div><div class="line">&gt;&gt;&gt; Content-Length: &lt;size of chunk&gt;</div><div class="line">&gt;&gt;&gt; Content-Range: &lt;start of range&gt;-&lt;end of range&gt;</div><div class="line">&gt;&gt;&gt; Content-Type: application/octet-stream</div><div class="line">&lt;Last Layer Chunk Binary Data&gt;</div><div class="line">RETURN</div><div class="line">201 Created</div><div class="line">Location: /v2/&lt;name&gt;/blobs/&lt;digest&gt;</div><div class="line">Content-Length: 0</div><div class="line">Docker-Content-Digest: &lt;digest&gt;</div><div class="line">Canceling an Upload(&#x53D6;&#x6D88;&#x4E0A;&#x4F20;)</div><div class="line">&#x8FD9;&#x4E2A;&#x8BF7;&#x6C42;&#x6267;&#x884C;&#x540E;uuid&#x5C06;&#x5931;&#x6548;&#xFF0C;&#x5F53;&#x4E0A;&#x4F20;&#x8D85;&#x65F6;&#x6216;&#x8005;&#x6CA1;&#x6709;&#x5B8C;&#x6210;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x90FD;&#x5E94;&#x8BE5;&#x53D1;&#x9001;&#x8FD9;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;</div><div class="line"></div><div class="line">API</div><div class="line">&gt;&gt;&gt; DELETE /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">Cross Repository Blob Mount&#xFF08;&#x4EA4;&#x53C9;&#x6302;&#x8F7D;&#x5C42;&#xFF09;</div><div class="line">&#x6B64;api&#x53EF;&#x628A;&#x5BA2;&#x6237;&#x7AEF;&#x6709;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x7684;&#x5DF2;&#x6709;&#x5B58;&#x50A8;&#x5E93;&#x4E2D;&#x7684;&#x5C42;&#x6302;&#x8F7D;&#x5230;&#x5F53;&#x524D;&#x50A8;&#x5B58;&#x5E93;&#x4E2D;&#x3002;</div><div class="line"></div><div class="line">API</div><div class="line">&gt;&gt;&gt; POST /v2/&lt;name&gt;/blobs/uploads/?mount=&lt;digest&gt;&amp;from=&lt;repository name&gt;</div><div class="line">Content-Length: 0</div><div class="line">RETURN</div><div class="line">&#x6210;&#x529F;&#x8FD4;&#x56DE;&#xFF1A;</div><div class="line">201 Created</div><div class="line">Location: /v2/&lt;name&gt;/blobs/&lt;digest&gt;</div><div class="line">Content-Length: 0</div><div class="line">Docker-Content-Digest: &lt;digest&gt;</div><div class="line">&#x5931;&#x8D25;&#x8FD4;&#x56DE;&#xFF1A;</div><div class="line">202 Accepted</div><div class="line">Location: /v2/&lt;name&gt;/blobs/uploads/&lt;uuid&gt;</div><div class="line">Range: bytes=0-&lt;offset&gt;</div><div class="line">Content-Length: 0</div><div class="line">Docker-Upload-UUID: &lt;uuid&gt;</div><div class="line">Deleting a Layer(&#x5220;&#x9664;&#x5C42;)</div><div class="line">API</div><div class="line">&gt;&gt;&gt; DELETE /v2/&lt;name&gt;/blobs/&lt;digest&gt;</div><div class="line">RETURN</div><div class="line">&#x6210;&#x529F;&#x8FD4;&#x56DE;&#xFF1A;</div><div class="line">202 Accepted</div><div class="line">Content-Length: None</div><div class="line">&#x5931;&#x8D25;&#x8FD4;&#x56DE;404&#x9519;&#x8BEF;&#x3002;</div><div class="line">Pushing an Image Manifest&#xFF08;&#x4E0A;&#x4F20;&#x955C;&#x50CF;&#x6E05;&#x5355;&#xFF09;</div><div class="line">&#x5F53;&#x955C;&#x50CF;&#x5C42;&#x4E0A;&#x4F20;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0A;&#x4F20;&#x6E05;&#x5355;&#x3002;</div><div class="line"></div><div class="line">API</div><div class="line">&gt;&gt;&gt; PUT /v2/&lt;name&gt;/manifests/&lt;reference&gt;</div><div class="line">Content-Type: &lt;manifest media type&gt;</div><div class="line">{</div><div class="line">   &quot;name&quot;: &lt;name&gt;,</div><div class="line">   &quot;tag&quot;: &lt;tag&gt;,</div><div class="line">   &quot;fsLayers&quot;: [</div><div class="line">      {</div><div class="line">         &quot;blobSum&quot;: &lt;digest&gt;</div><div class="line">      },</div><div class="line">      ...</div><div class="line">    ]</div><div class="line">   ],</div><div class="line">   &quot;history&quot;: &lt;v1 images&gt;,</div><div class="line">   &quot;signature&quot;: &lt;JWS&gt;,</div><div class="line">   ...</div><div class="line">}</div><div class="line">RETURN</div><div class="line">&#x5982;&#x679C;&#x6E05;&#x5355;&#x4E2D;&#x6709;&#x5C42;&#x662F;&#x672A;&#x77E5;&#x7684;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#xFF1A;</div><div class="line"></div><div class="line">{</div><div class="line"> &quot;errors:&quot; [{</div><div class="line">         &quot;code&quot;: &quot;BLOB_UNKNOWN&quot;,</div><div class="line">         &quot;message&quot;: &quot;blob unknown to registry&quot;,</div><div class="line">         &quot;detail&quot;: {</div><div class="line">             &quot;digest&quot;: &lt;digest&gt;</div><div class="line">         }</div><div class="line">     },</div><div class="line">     ...</div><div class="line">  ]</div><div class="line">}</div><div class="line">&#x68C0;&#x7D22;&#x529F;&#x80FD;</div><div class="line"></div><div class="line">Listing Repositories&#xFF08;&#x5217;&#x51FA;&#x5B58;&#x50A8;&#x5E93;&#xFF09;</div><div class="line">API</div><div class="line">&gt;&gt;&gt; GET /v2/_catalog</div><div class="line">RETURN</div><div class="line">200 OK</div><div class="line">Content-Type: application/json</div><div class="line">{</div><div class="line">  &quot;repositories&quot;: [</div><div class="line">    &lt;name&gt;,</div><div class="line">    ...</div><div class="line">  ]</div><div class="line">}</div><div class="line">Pagination(&#x90E8;&#x5206;&#x5217;&#x51FA;&#x5B58;&#x50A8;&#x5E93;)</div><div class="line">API</div><div class="line">&gt;&gt;&gt; GET /v2/_catalog?n=&lt;integer&gt;</div><div class="line">Note</div><div class="line"></div><div class="line">integer&#x8868;&#x793A;&#x8981;&#x5217;&#x51FA;&#x5E93;&#x7684;&#x4E2A;&#x6570;</div><div class="line">RETURN</div><div class="line">200 OK</div><div class="line">Content-Type: application/json</div><div class="line">Link: &lt;&lt;url&gt;?n=&lt;n from the request&gt;&amp;last=&lt;last repository in response&gt;&gt;; rel=&quot;next&quot;</div><div class="line">{</div><div class="line">  &quot;repositories&quot;: [</div><div class="line">    &lt;name&gt;,</div><div class="line">    ...</div><div class="line">  ]</div><div class="line">}</div><div class="line">Listing Image Tags(&#x5217;&#x51FA;&#x955C;&#x50CF;tag)</div><div class="line">API</div><div class="line">&gt;&gt;&gt; GET /v2/&lt;name&gt;/tags/list</div><div class="line">RETURN</div><div class="line">200 OK</div><div class="line">Content-Type: application/json</div><div class="line">{</div><div class="line">    &quot;name&quot;: &lt;name&gt;,</div><div class="line">    &quot;tags&quot;: [</div><div class="line">        &lt;tag&gt;,</div><div class="line">        ...</div><div class="line">    ]</div><div class="line">}</div><div class="line">Pagination(&#x90E8;&#x5206;&#x5217;&#x51FA;&#x955C;&#x50CF;tag)</div><div class="line">API</div><div class="line">&gt;&gt;&gt; GET /v2/&lt;name&gt;/tags/list?n=&lt;integer&gt;</div><div class="line">RETURN</div><div class="line">200 OK</div><div class="line">Content-Type: application/json</div><div class="line">Link: &lt;&lt;url&gt;?n=&lt;n from the request&gt;&amp;last=&lt;last tag value from previous response&gt;&gt;; rel=&quot;next&quot;</div><div class="line">{</div><div class="line">  &quot;name&quot;: &lt;name&gt;,</div><div class="line">  &quot;tags&quot;: [</div><div class="line">    &lt;tag&gt;,</div><div class="line">    ...</div><div class="line">  ]</div><div class="line">}</div><div class="line">Deleting an Image(&#x5220;&#x9664;&#x955C;&#x50CF;)</div><div class="line"></div><div class="line">API</div><div class="line">&gt;&gt;&gt; DELETE /v2/&lt;name&gt;/manifests/&lt;reference&gt;</div><div class="line">RETURN</div><div class="line">&#x6210;&#x529F;</div><div class="line">202 Accepted</div><div class="line">Content-Length: None</div><div class="line">&#x5931;&#x8D25;&#x8FD4;&#x56DE;404&#x9519;&#x8BEF;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/docker/" rel="tag">#docker</a>
          
            <a href="/tags/registry/" rel="tag">#registry</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/10/linux-bash-position/" rel="next" title="Linux Bash Shell 位置变量详解">
                <i class="fa fa-chevron-left"></i> Linux Bash Shell 位置变量详解
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/11/17/mysql-performance/" rel="prev" title="mysql性能查询以及简单处理">
                mysql性能查询以及简单处理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/avatar.jpg"
               alt="Casstiel" />
          <p class="site-author-name" itemprop="name">Casstiel</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">26</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#摘要"><span class="nav-number">1.</span> <span class="nav-text">摘要</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装docker"><span class="nav-number">2.</span> <span class="nav-text">安装docker</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#重建docker0网桥"><span class="nav-number">3.</span> <span class="nav-text">重建docker0网桥</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#下载docker-registry-镜像"><span class="nav-number">4.</span> <span class="nav-text">下载docker registry 镜像</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#registry-测试"><span class="nav-number">5.</span> <span class="nav-text">registry 测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#启动测试"><span class="nav-number">5.1.</span> <span class="nav-text">启动测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#推送验证"><span class="nav-number">5.2.</span> <span class="nav-text">推送验证</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#带验证的registry"><span class="nav-number">6.</span> <span class="nav-text">带验证的registry</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建本地目录"><span class="nav-number">6.1.</span> <span class="nav-text">创建本地目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生成用户和密码"><span class="nav-number">6.2.</span> <span class="nav-text">生成用户和密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建配置文件"><span class="nav-number">6.3.</span> <span class="nav-text">创建配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#启动命令"><span class="nav-number">6.4.</span> <span class="nav-text">启动命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#验证测试"><span class="nav-number">6.5.</span> <span class="nav-text">验证测试</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#给registry添加nginx-https代理验证"><span class="nav-number">7.</span> <span class="nav-text">给registry添加nginx+https代理验证</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#编译安装nginx1-9-15、创建ngxin启动文件、创建nginx配置文件请参照另一篇文章"><span class="nav-number">7.1.</span> <span class="nav-text">编译安装nginx1.9.15、创建ngxin启动文件、创建nginx配置文件请参照另一篇文章</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#制作ca证书"><span class="nav-number">7.2.</span> <span class="nav-text">制作ca证书</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生成服务端证书并用ca证书认证"><span class="nav-number">7.3.</span> <span class="nav-text">生成服务端证书并用ca证书认证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生成验证文件"><span class="nav-number">7.4.</span> <span class="nav-text">生成验证文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建虚拟主机"><span class="nav-number">7.5.</span> <span class="nav-text">创建虚拟主机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#client-配置"><span class="nav-number">7.6.</span> <span class="nav-text">client 配置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#docker-api"><span class="nav-number">8.</span> <span class="nav-text">docker api</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#专有名词解释"><span class="nav-number">9.</span> <span class="nav-text">专有名词解释</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Casstiel</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/myvendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/myvendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/myvendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/myvendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/myvendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/myvendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  

  

  

  

</body>
</html>
